<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Remote Control Via Email | Huy Mai </title> <meta name="author" content="Huy Mai"> <meta name="description" content="(CSC10008) DHCP"> <meta name="keywords" content="deep-learning, artificial-intelligence, neuroscience"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%A7%91%E2%80%8D%F0%9F%92%BB&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://sabertoaster.github.io/projects/remotecontrolviaemail/"> <script src="/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/vi/"> <span class="font-weight-bold">Huy</span> Mai </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/vi/">About </a> </li> <li class="nav-item "> <a class="nav-link" href="/vi/blog/">Blog </a> </li> <li class="nav-item active"> <a class="nav-link" href="/vi/projects/">Works <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/vi/news/">Logs </a> </li> <li class="nav-item "> <a class="nav-link" href="/vi/cv/">CV </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Remote Control Via Email</h1> <p class="post-description">(CSC10008) DHCP</p> </header> <article> <h2 id="introduction">Introduction</h2> <p>In today’s increasingly connected world, the ability to remotely manage systems securely is more important than ever. While there are many remote administration tools available, many require direct network connections that can be blocked by firewalls or NAT configurations.</p> <p>Our project, <strong>RemoteControl Via Email</strong>, addresses this challenge by leveraging email communication as a transport medium for remote control commands. This approach allows administrators to manage systems from anywhere, bypassing traditional network restrictions.</p> <p>This project was developed as part of the Computer Networks course at Ho Chi Minh City University of Science (HCMUS) by a team of three students:</p> <ul> <li> <strong>Mai Đức Minh Huy</strong> (23122008) - Team Lead, server socket programming, reporting</li> <li> <strong>Nguyễn Thiên Ấn</strong> (23122020) - Gmail API integration, component integration, testing</li> <li> <strong>Nguyễn Lê Hoàng Trung</strong> (23122004) - GUI client design, video demo, documentation</li> </ul> <p><a href="https://drive.google.com/file/d/1JLrnlqJ0fPrAmBOoKK0lqJl34vVrsOhC/view?usp=sharing" rel="external nofollow noopener" target="_blank">Report featured in the project</a></p> <h2 id="architecture">Architecture</h2> <p>The system consists of three main components working together:</p> <ol> <li> <p><strong>Remote User</strong>: The person who wants to control the target computer remotely by sending command emails</p> </li> <li> <strong>Client Application</strong>: A wxWidgets-based GUI intermediary that: <ul> <li>Connects to remote machines by their IP addresses</li> <li>Authenticates using Gmail credentials with app passwords</li> <li>Periodically checks for new command emails</li> <li>Parses email content into commands for the server</li> <li>Sends command results back via email</li> <li>Provides a visual interface for direct control</li> </ul> </li> <li> <strong>Server Application</strong>: A C++ background service running on the target machine that: <ul> <li>Listens for incoming connections using socket programming</li> <li>Responds to discovery requests on a LAN</li> <li>Executes system commands with appropriate permissions</li> <li>Captures screen and webcam content</li> <li>Manages processes, services, and the file system</li> <li>Returns detailed results to the client</li> </ul> </li> </ol> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/projects/remotecontrolviaemail/rcve-architecture-480.webp 480w,/assets/img/projects/remotecontrolviaemail/rcve-architecture-800.webp 800w,/assets/img/projects/remotecontrolviaemail/rcve-architecture-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/projects/remotecontrolviaemail/rcve-architecture.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" alt="System Architecture" data-zoomable="" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> High-level architecture of the RemoteControl Via Email system </div> <h2 id="key-features">Key Features</h2> <h3 id="security-first-design">Security-First Design</h3> <ul> <li>SSL-encrypted connections using OpenSSL</li> <li>Gmail authentication with app password support for enhanced security</li> <li>Local network discovery with authentication checks</li> <li>Secure command transmission over sockets</li> </ul> <h3 id="comprehensive-system-management">Comprehensive System Management</h3> <ul> <li>Process management: listing all running processes categorized by type (Apps, Background, Windows)</li> <li>Service control: listing, starting, and stopping Windows services with status monitoring</li> <li>File system operations: disk enumeration, directory scanning, file retrieval and deletion</li> <li>Screen capture functionality with image transmission</li> <li>Webcam access, control and capture capabilities</li> <li>Power management (shutdown, restart, sleep) with configurable options</li> </ul> <h3 id="resilient-communication">Resilient Communication</h3> <ul> <li>Email-based command and response system that works across network boundaries</li> <li>Structured request-response protocol with defined command format</li> <li>Automatic discovery of compatible servers on the local network via UDP broadcasting</li> <li>Support for attachments (images, file content) in responses</li> <li>Custom error handling and recovery mechanisms</li> </ul> <h2 id="technical-implementation">Technical Implementation</h2> <p>The project leverages several technologies and libraries:</p> <ul> <li> <strong>wxWidgets</strong>: For the cross-platform GUI components including custom buttons, file explorer, and process/service managers</li> <li> <strong>libcurl</strong>: For handling email communication via IMAP/SMTP protocols with Gmail</li> <li> <strong>OpenSSL</strong>: For secure SSL/TLS communication and certificate verification</li> <li> <strong>Windows API</strong>: For comprehensive system management operations</li> <li> <strong>Winsock2</strong>: For socket programming and network communication</li> <li> <strong>DirectShow/GDI+</strong>: For webcam control and image processing</li> </ul> <p>The command structure follows a simple pattern:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>!command [parameters]
</code></pre></div></div> <p>With a structured response protocol that includes:</p> <ol> <li>Size of any attachment (if present)</li> <li>Binary attachment data (if present)</li> <li>Size of the message response</li> <li>Message content</li> </ol> <p>One interesting technical challenge was implementing the webcam control functionality that captures frames in real-time:</p> <div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">void</span> <span class="n">WebcamController</span><span class="o">::</span><span class="n">WebcamThread</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// Initialize DirectShow objects</span>
    <span class="c1">// ...</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="n">SUCCEEDED</span><span class="p">(</span><span class="n">hr</span><span class="p">))</span> <span class="p">{</span>
        <span class="c1">// Start capturing</span>
        <span class="n">hr</span> <span class="o">=</span> <span class="n">pControl</span><span class="o">-&gt;</span><span class="n">Run</span><span class="p">();</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">SUCCEEDED</span><span class="p">(</span><span class="n">hr</span><span class="p">))</span> <span class="p">{</span>
            <span class="n">std</span><span class="o">::</span><span class="n">unique_lock</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">mutex</span><span class="o">&gt;</span> <span class="n">lock</span><span class="p">(</span><span class="n">mtx</span><span class="p">);</span>
            <span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="n">stopRequested</span><span class="p">)</span> <span class="p">{</span>
                <span class="c1">// Grab frame</span>
                <span class="kt">long</span> <span class="n">cbBuffer</span> <span class="o">=</span> <span class="n">bufferSize</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">SUCCEEDED</span><span class="p">(</span><span class="n">pGrabber</span><span class="o">-&gt;</span><span class="n">GetCurrentBuffer</span><span class="p">(</span><span class="o">&amp;</span><span class="n">cbBuffer</span><span class="p">,</span> <span class="p">(</span><span class="kt">long</span><span class="o">*</span><span class="p">)</span><span class="n">buffer</span><span class="p">)))</span> <span class="p">{</span>
                    <span class="c1">// Convert to JPEG using GDI+</span>
                    <span class="c1">// ...</span>
                    
                    <span class="c1">// Update currentFrame</span>
                    <span class="p">{</span>
                        <span class="n">std</span><span class="o">::</span><span class="n">lock_guard</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">mutex</span><span class="o">&gt;</span> <span class="n">frameLock</span><span class="p">(</span><span class="n">frameMutex</span><span class="p">);</span>
                        <span class="n">currentFrame</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">jpegSize</span><span class="p">);</span>
                        <span class="kt">void</span><span class="o">*</span> <span class="n">ptr</span> <span class="o">=</span> <span class="n">GlobalLock</span><span class="p">(</span><span class="n">hg</span><span class="p">);</span>
                        <span class="n">memcpy</span><span class="p">(</span><span class="n">currentFrame</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span> <span class="n">ptr</span><span class="p">,</span> <span class="n">jpegSize</span><span class="p">);</span>
                        <span class="n">GlobalUnlock</span><span class="p">(</span><span class="n">hg</span><span class="p">);</span>
                    <span class="p">}</span>
                <span class="p">}</span>
                <span class="c1">// Wait for next frame (approximately 30fps)</span>
                <span class="n">cv</span><span class="p">.</span><span class="n">wait_for</span><span class="p">(</span><span class="n">lock</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">chrono</span><span class="o">::</span><span class="n">milliseconds</span><span class="p">(</span><span class="mi">33</span><span class="p">));</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <h2 id="program-workflow">Program Workflow</h2> <p>The typical flow of operations follows this sequence:</p> <ol> <li>Remote user sends an email containing a command to the client’s Gmail account</li> <li>Client periodically checks Gmail for new commands using libcurl</li> <li>When a new command email arrives, the client parses the command</li> <li>Client establishes a socket connection to the server (or uses existing connection)</li> <li>Client sends the command to the server in the format <code class="language-plaintext highlighter-rouge">!command [parameters]</code> </li> <li>Server executes the command with appropriate system permissions</li> <li>Server sends back structured response with sizes and data</li> <li>Client formats the response and sends it back to the remote user via email</li> <li>For special commands like screenshots or webcam captures, binary attachments are included</li> </ol> <h2 id="command-api-examples">Command API Examples</h2> <p>The system supports numerous command types:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>!help                  # List all available commands
!list p                # List all running processes
!list s                # List all Windows services
!screenshot            # Capture screen and return image
!webcam                # Toggle webcam on/off
!capture               # Capture frame from webcam
!shutdown [0/1/2]      # Shutdown/power off/restart
!list disks            # List available drives
!index [drive]         # Scan file system structure
!get file [path]       # Download specified file
!delete file [path]    # Delete specified file
!endp [process_id]     # Terminate a process
!ends [service_name]   # Stop a service
!starts [service_name] # Start a service
</code></pre></div></div> <h2 id="conclusion">Conclusion</h2> <p>The RemoteControl Via Email project demonstrates the flexibility of using alternative communication channels for system administration. By leveraging email as a transport medium, we’ve created a system that can operate effectively even in restricted network environments.</p> <p>Future improvements could include:</p> <ul> <li>Adding end-to-end encryption for command payloads</li> <li>Extending platform support beyond Windows</li> <li>Implementing scheduled command execution</li> <li>Adding more advanced file operations and transfer capabilities</li> </ul> <h3 id="resources">Resources</h3> <p>The complete source code and documentation are available at:</p> <ul> <li>GitHub repository: <a href="https://github.com/p1neapplechoco/RemoteControlViaEmail" rel="external nofollow noopener" target="_blank">https://github.com/p1neapplechoco/RemoteControlViaEmail</a> </li> <li>Demo video: <a href="https://youtu.be/jOmx03PVJhc" rel="external nofollow noopener" target="_blank">https://youtu.be/jOmx03PVJhc</a> </li> </ul> </article> <div id="giscus_thread"> <script>
      let giscusTheme = determineComputedTheme();
      let giscusAttributes = {
        src: 'https://giscus.app/client.js',
        'data-repo': 'sabertoaster/sabertoaster.github.io',
        'data-repo-id': 'R_kgDONJ-QGg',
        'data-category': 'General',
        'data-category-id': 'DIC_kwDONJ-QGs4CnyrA',
        'data-mapping': 'title',
        'data-strict': '1',
        'data-reactions-enabled': '1',
        'data-emit-metadata': '0',
        'data-input-position': 'top',
        'data-theme': giscusTheme,
        'data-lang': 'en',
        crossorigin: 'anonymous',
        async: '',
      };

      let giscusScript = document.createElement('script');
      Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value));
      document.getElementById('giscus_thread').appendChild(giscusScript);
    </script> <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by giscus.</a> </noscript> </div> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Huy Mai. al-folio theme </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>